<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE sqlMap PUBLIC "-//ibatis.apache.org//DTD SQL Map 2.0//EN" "http://ibatis.apache.org/dtd/sql-map-2.dtd">
<sqlMap namespace="EP_DEVICE_VIEW">
  <resultMap class="com.megaeyes.persistence.ibatis.model.EpDevice" id="_EpDeviceResult">
    <result column="ID" jdbcType="VARCHAR" property="id" />
    <result column="NAME" jdbcType="VARCHAR" property="name" />
    <result column="ORGAN_ID" jdbcType="VARCHAR" property="organId" />
    <result column="PARENT_ID" jdbcType="VARCHAR" property="parentId" />
    <result column="TYPE" jdbcType="DECIMAL" property="type" />
    <result column="NOTE" jdbcType="VARCHAR" property="note" />
  </resultMap>
  
 <resultMap id="abatorgenerated_EpDeviceResult" class="com.megaeyes.persistence.ibatis.model.EpDevice" >
    <!--
      WARNING - This element is automatically generated by Abator for iBATIS, do not modify.
      This element was generated on Thu Jun 07 02:51:01 GMT 2012.
    -->
    <result column="ID" property="id" jdbcType="VARCHAR" />
    <result column="NAME" property="name" jdbcType="VARCHAR" />
    <result column="ORGAN_ID" property="organId" jdbcType="VARCHAR" />
    <result column="PARENT_ID" property="parentId" jdbcType="VARCHAR" />
    <result column="TYPE" property="type" jdbcType="DECIMAL" />
    <result column="NOTE" property="note" jdbcType="VARCHAR" />
    <result column="OPERATION" property="operation" jdbcType="VARCHAR" />
  </resultMap>
  
   <resultMap class="com.megaeyes.persistence.ibatis.vo.ListVicVO" id="_ListVicVOResult">
    <result column="MONITOR_ID" jdbcType="VARCHAR" property="monitorId" />
    
  </resultMap>
  
    <resultMap class="com.megaeyes.persistence.ibatis.vo.ListDeviceByIntelligentVO" id="_ListDeviceByIntelligentVOResult">
    <result column="ID" jdbcType="VARCHAR" property="id" />
    <result column="PLC_IO_TYPE" property="plcIoType" jdbcType="VARCHAR" />
    <result column="ORGAN_ID" property="organId" jdbcType="VARCHAR" />
    <result column="NAME" property="name" jdbcType="VARCHAR" />
    <result column="MIN_LIMIT" property="minLimit" jdbcType="DECIMAL" />
    <result column="MAX_LIMIT" property="maxLimit" jdbcType="DECIMAL" />
    <result column="CYCLE" property="cycle" jdbcType="DECIMAL" />
    <result column="IS_WARN" property="isWarn" jdbcType="DECIMAL" />
    <result column="BOOL_WARN" property="boolWarn" jdbcType="DECIMAL" />
    <result column="GATHER_NAME" jdbcType="VARCHAR" property="gatherName" />
    <result column="GATHER_SERVER_ID" jdbcType="VARCHAR" property="gatherServerId" />
    <result column="GATHER_SERVER_IP" jdbcType="VARCHAR" property="gatherServerIp" />
     <result column="POSITION" jdbcType="VARCHAR" property="position" />
  </resultMap>
  
   <select id="listEDLByOrganId" resultMap="_EpDeviceResult">
  	select * from EP_DEVICE where ORGAN_ID = #organId# and type = 2
  </select>

	<select id="listDeviceByDeviceId" resultMap="_ListVicVOResult">
		select b.monitor_id from EP_MONITOR_DEVICE a, EP_R_MONITOR_DEVICE b where
		a.id=b.monitor_id and b.device_id=#deviceId#
	</select>

<select id="listDeviceByIntelligentId" resultMap="_ListDeviceByIntelligentVOResult">
				select 
					t.id,
					t.plc_io_type,
					t.organ_id,
					t.name,
					t.max_Limit,
					t.min_Limit,
					t.cycle,
					t.is_Warn,
					t.bool_Warn,
					t.position,
					g.name as GATHER_NAME,
					g.id as GATHER_SERVER_ID,
					g.ip as GATHER_SERVER_IP 
				from 
					ep_prober t,
					ep_gather_server g,
					ep_control_server ecs,
					ep_r_monitor_device ermd
				where 	
				    ermd.device_id = #intelligentId# 
					and ermd.monitor_id = t.id 
					and t.control_server_id = ecs.id 
					and ecs.gather_server_id = g.id
					and t.organ_id = #organId#
	</select>	
	
	<select id="listDomainsByOrganId" resultMap="abatorgenerated_EpDeviceResult" >
		select * from ep_device t where (organ_id = '0' and type = 4) or (organ_id = #organId# and type = 4)		
	</select>	

</sqlMap>  